{% extends "network/layout.html" %}

{% block body %}

<!--
<div>
    <h3>New Post</h3>
    <textarea name="" id="" cols="100" rows="5"> Show text area from the form in views {{ form }} </textarea>
    <button type="submit" id="addpost" class="btn btn-primary">Post</button>
</div>
-->

<!--
  <form action="{% url 'network:create' %}" method="post">
    {% csrf_token %}
    {{ form }}
    <input type="submit" value="SAVE">
</form>
-->


<h2>All Posts</h2>
<ul style="list-style-type: none;">
    {% for post in posts %}
    <div style="border: 1px solid beige; margin:10px; padding: 10px">
        <div style="display: flex; align-items: center;">

            <!-- Name -->
            <li style="margin-right: 10px;">
                <a href="{% url 'network:profile' username=post.created_by.username %}" style="text-decoration: none;">
                    <strong>{{ post.created_by }}</strong>
                </a>
            </li>
        
            <!-- Follow Button -->
            <li>
                <form method="POST" action="{% url 'network:follow_toggle' %}" id="follow-form-{{ post.id }}" class="follow-form">
                    {% csrf_token %}
                    <input type="hidden" name="posted_by" value="{{ post.created_by }}">
                    <button type="submit" class="btn {% if post.is_following %}btn-danger{% else %}btn-info{% endif %} mt-2 ml-2">
                        {% if not post.is_following %}
                            Follow
                        {% else %}
                            Unfollow
                        {% endif %}
                    </button>
                </form>
            </li>
        
        </div>
        
        <li>{{ post.post }}</li>

        {% if user.is_authenticated %}
            {% if user_profile.user|lower == post.created_by.username|lower %}
            <ul style="display: flex;">
                <li style="font-size: 70%;"><a href="{% url 'network:edit' post.id %}">Edit post</a></li>
            </ul>    
            {% endif %}
        {% endif %}

    
        <li>{{ post.created_date }}</li>
        <li>❤️ {{ post.likes.count }} </li>
        <form method="post" action="{% url 'network:like_post' post_id=post.id %}">
            {% csrf_token %}
            <button type="submit">
                {% if user in post.likes.all %}
                    Unlike
                {% else %}
                    Like
                {% endif %}
            </button>
        </form>

    </div>
    {% endfor %}
</ul>
{% endblock %}



<!--<li style="font-size: 70%;"><a href="{% url 'network:edit' %}">Edit post</a></li>-->

<!--{% url 'network:profile' request.post.created_by %}-->

<!--<li style="font-size: 70%;"><a href="{% url 'network:edit' %}">Edit post</a></li>-->

<!--{% url 'network:profile' request.post.created_by %}-->